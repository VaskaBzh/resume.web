var x=Object.defineProperty;var A=(s,t,i)=>t in s?x(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var n=(s,t,i)=>(A(s,typeof t!="symbol"?t+"":t,i),i);import{M as L}from"./MainTitle-5abaae33.js";import{G as B,B as D,M as N,a as G,b as k}from"./BarGraphData-2d15976d.js";import{M as W}from"./MainSlider-cf396ea1.js";import{T as V,a as T,R as F,b as O}from"./TableTitles-46c1357e.js";import{m as S,_ as w,r as a,o as h,c as v,a as p,d as o,F as f,k as I,g,n as d,u as U,P as X,C as H,h as y,j as C,T as K,b as $,t as j}from"./app-7a3a58ff.js";import{a as z,I as Y}from"./InstructionService-d77d7f22.js";import{I as q}from"./InstructionButton-391a8821.js";/* empty css                                                                  */import"./converter-ec486320.js";import"./TooltipCard-430f11e3.js";import"./transform-fa9976d2.js";import"./anime.es-de4e5aa0.js";import"./DefaultSubsService-b95954c2.js";import"./MainPreloader-edb92089.js";import"./StatesService-a0d6c34c.js";import"./MainIcon-57980112.js";const J={name:"MainTable",components:{TableTitles:V,TableRow:T},props:{viewportWidth:Number,table:Object,errors:Object,component:{default:T}},methods:{deligateProcess(s){s.target.closest("[data-copy]")&&navigator.clipboard.writeText(s.target.closest("[data-copy]").innerText)}},computed:{...S(["allHistoryMiner"]),titles(){var s,t;return(s=this.table)!=null&&s.titles?(t=this.table)==null?void 0:t.titles:null}},data(){return{redraw:!0}}},Q={class:"table"},Z={class:"table__head"};function tt(s,t,i,r,e,_){var l;const m=a("table-titles");return h(),v("table",Q,[p("thead",Z,[o(m,{class:"table__row-income",titles:_.titles},null,8,["titles"])]),p("tbody",{class:"table__body",onClick:t[0]||(t[0]=(...c)=>_.deligateProcess&&_.deligateProcess(...c))},[(h(!0),v(f,null,I((l=i.table)==null?void 0:l.rows,(c,b)=>(h(),g(U(i.component),{key:b,columns:c,titles:_.titles,"viewport-width":i.viewportWidth,class:d(c.class??null),"data-popup":c.data},null,8,["columns","titles","viewport-width","class","data-popup"]))),128))])])}const et=w(J,[["render",tt]]);const st={name:"IncomeRow",components:{RowColumn:F},props:{columns:Array,titles:Array},computed:{...S(["viewportWidth"])},data(){return{service:new O}},watch:{columns(s){this.service.rowProcess(s,this.titles)},titles(s){this.service.rowProcess(this.columns,s)}},mounted(){this.service.rowProcess(this.columns,this.titles)}},it={class:"table__row"};function nt(s,t,i,r,e,_){const m=a("row-column");return h(),v("tr",it,[(h(!0),v(f,null,I(e.service.filteredColumns,(l,c)=>(h(),g(m,{key:c,class:"column-income",value:l[1],"column-key":l[0]},null,8,["value","column-key"]))),128))])}const rt=w(st,[["render",nt],["__scopeId","data-v-c81768f6"]]),ot={en:{title:"Income",block:{titles:{full_income:"Accrued for all time",income:"Accrued",yesterday_amount:"Yesterday's income",month_profit:"Monthly income",month_profit_graph:"Monthly income chart"},hints:{income:`On your subaccount <span class="tooltip_text-blue">0.00051380 BTC</span> /
                    Auto payout occurs when the balance is <span class="tooltip_text-blue">> 0.005 BTC</span>`}}},ru:{title:"Доход",block:{titles:{full_income:"Начислено за все время",income:"Текущий баланс",yesterday_amount:"Вчерашний доход",month_profit:"Доход за месяц",month_profit_graph:"График дохода за месяц"},hints:{income:`На вашем субаккаунте <span class="tooltip_text-blue">0.00051380 BTC</span> /
                    Автовыплата происходит при  балансе <span class="tooltip_text-blue">> 0.005 BTC</span>`}}}};class at{constructor(){this.isWait=!0,this.isEmpty=!1,this.isEnd=!1}waitResponse(){return this.isEmpty=!1,this.isEnd=!1,this.isWait=!0,this}endResponse(){return this.isWait=!1,this.isEnd=!0,this}emptyResponse(){return this.isWait=!1,this.isEnd=!0,this.isEmpty=!0,this}}class lt{async incomes(t,i=1,r=1e3){return await X.get(`/incomes/${t}?page=${i}&per_page=${r}`)}}class ct{getResponseData(t){if(!(t!=null&&t.data))return t;if(t!=null&&t.data)return this.getResponseData(t.data)}isEmptyResponse(t){return t.length===0}}class ut{constructor(){n(this,"rows");n(this,"rowsData");n(this,"titleString");n(this,"titlesLength")}setTitlesLength(t){return this.titlesLength=t,this}setTitleString(t){return this.titleString=t,this}get titles(){const t=[];for(let i=0;i<this.titlesLength;i++)t.push(`${this.titleString}[${i}]`);return t}setRowsData(t){return this.rowsData=t,this}setRows(t){return this.rows=t.map(i=>new this.rowsData(i)),this}get table(){return{titles:this.titles,rows:this.rows}}}class ht{constructor(t){this.links=t.url,this.label=t.label,this.isActive=t.active}}class pt{constructor(){n(this,"FIRST_ELEMENT_INDEX",0);n(this,"CLEAR_URL_INDEX",1);n(this,"meta",null);n(this,"links",null);n(this,"pagination",null);n(this,"prevLink",null);n(this,"nextLink",null)}setLinks(){const t=this.meta.links.length-1;return this.links=this.meta.links.filter((i,r)=>r!==0&&r!==t),this}setMeta(t){return this.meta=t,this}setButtonsLinks(){const t=this.meta.links.length-1;return this.prevLink=this.getClearUrl(this.meta.links[this.FIRST_ELEMENT_INDEX].url),this.nextLink=this.getClearUrl(this.meta.links[t].url),this}setPagination(){return this.pagination=this.links.map(t=>new ht(t)),this}getClearUrl(t){return t&&t.split("v1/")[this.CLEAR_URL_INDEX]}paginationProcess(t){this.setMeta(t).setButtonsLinks().setLinks().setPagination()}}class _t{constructor(){n(this,"keyToFind",null)}findValueByKey(t,i){if(this.keyToFind||(this.keyToFind=i),t&&t[this.keyToFind]!==void 0)return t[this.keyToFind];for(let r in t)if(typeof t[r]=="object"&&!Array.isArray(t[r])&&t[r]!==null){const e=this.findValueByKey(t[r]);if(e)return e}}}class mt{constructor(){n(this,"GROUP_ID_PARAMS_INDEX",0);n(this,"savedParams",null);n(this,"savedClient",null);n(this,"eventsCount",0);this.client=this.createClient(),this.tableModel=this.createTableModel(),this.paginationModel=this.createPaginationModel(),this.responseTrait=this.useResponseTrait(),this.objectTrait=this.useObjectTrait(),this.tableStates=this.createTableControllService()}createPaginationModel(){return new pt}createTableModel(){return new ut}createClient(){return new lt}useResponseTrait(){return new ct}useObjectTrait(){return new _t}createTableControllService(){return new at}saveArguments(t,i){this.savedClient=t,this.savedParams=i}async restartFetchWithNewGroupId(t){const i=this.savedParams;i[this.GROUP_ID_PARAMS_INDEX]=t.detail.group_id,await this.fetch(this.savedClient,...i)}async createRestartListener(){this.eventsCount<1&&(document.addEventListener("changeGroupId",await this.restartFetchWithNewGroupId.bind(this),!0),this.eventsCount++)}async fetch(t,...i){if(this.saveArguments(t,i),await this.createRestartListener(),i[this.GROUP_ID_PARAMS_INDEX]===-1)return null;this.tableStates.waitResponse();try{const r=await this.client[t](...i),e=this.responseTrait.getResponseData(r);return this.responseTrait.isEmptyResponse(e)?(this.tableStates.emptyResponse(),this):(this.tableModel.setRows(e),this.tableStates.endResponse(),this)}catch(r){return console.error(`Error with: ${r}`),this.tableStates.emptyResponse(),this}}}class bt{constructor(t){this.incomeDate=t.income_at,this.income=`${t.amount} BTC`,this.hash_per_day=t.hash,this.hash_per_day_unit=t.unit??"T",this.renderHashRate=`${this.hash_per_day} ${this.hash_per_day_unit}H/s`,this.payoutDate=t.payout_at||"-",this.walletAddress=this.getCuttedWallet(t.wallet),this.payout=t.payout?`${t.payout} BTC`:"-",this.txid=t.tx_id||"-",this.status=t.status}getCuttedWallet(t){let i="-";return t&&(i=t.substr(0,6)+"..."+t.substr(t.length-6,t.length)),i}}class vt{constructor(){this.graphService=new B(30),this.waitGraphChange=!0,this.tableService=this.createTableService()}createTableService(){return new mt}async index(){this.tableService.tableModel.setTitlesLength(8).setTitleString("income.table.titles").setRowsData(bt),this.waitGraphChange=!0,this.graphService.setDefaultKeys(60*60*1e3*24),await this.tableService.fetch("incomes",H.getters.getActive,1,20)}get table(){return this.tableService.tableModel.table}get isWait(){return this.tableService.tableStates.isWait}get isEnd(){return this.tableService.tableStates.isEnd}get isEmpty(){return this.tableService.tableStates.isEmpty}}const dt={name:"IncomePage",components:{MainSlider:W,BtcCalculator:D,MainTitle:L,MainBarGraph:N,MainProgressBar:G,MainTable:et,InstructionButton:q,InstructionStep:z},computed:{...S(["getAccount","getActive"]),IncomeRow(){return rt}},i18n:{sharedMessages:ot},watch:{async"$i18n.locale"(){document.title=this.$t("header.links.income"),await this.service.index()},async"service.tableService.tableModel.rows"(s){s.length>0?(this.service.graphService.records=s.map(t=>new k(t)),await this.service.graphService.makeFullBarValues(),this.service.waitGraphChange=!1):(this.service.graphService.records=new k({income:0}),this.service.waitGraphChange=!1)}},data(){return{service:new vt,instructionService:new Y,isMounted:!1}},async mounted(){this.isMounted=!0,document.title=this.$t("header.links.income"),this.instructionService.setStepsCount(3),await this.service.index()}},gt={class:"income"},yt={class:"income__head"},St={class:"cabinet__block cabinet__block-card cabinet__block-light income__block income__block-first"},wt={class:"cabinet__block cabinet__block-card cabinet__block-light income__block"};function ft(s,t,i,r,e,_){const m=a("main-title"),l=a("btc-calculator"),c=a("main-progress-bar"),b=a("instruction-step"),M=a("main-bar-graph"),E=a("main-table"),P=a("main-slider"),R=a("instruction-button");return h(),v(f,null,[p("div",gt,[o(m,{class:"title-profile"},{default:y(()=>[$(j(s.$t("title")),1)]),_:1}),p("div",yt,[p("div",{class:d(["income__wrap onboarding_block",{"onboarding_block-target":e.instructionService.isVisible&&e.instructionService.step===1}])},[p("div",St,[o(l,{title:s.$t("block.titles.full_income"),bitcoin:s.getAccount.total_amount||0},null,8,["title","bitcoin"]),o(c,{title:s.$t("block.titles.income"),progress:s.getAccount.pending_amount||0,final:.005,unit:"BTC"},null,8,["title","progress","final"])]),p("div",wt,[o(l,{title:s.$t("block.titles.yesterday_amount"),bitcoin:s.getAccount.yesterday_amount||0},null,8,["title","bitcoin"])]),o(b,{step_active:1,steps_count:e.instructionService.steps_count,step:e.instructionService.step,"is-visible":e.instructionService.isVisible,text:"texts.income[0]",title:"titles.income[0]","class-name":"onboarding__card-top",onNext:t[0]||(t[0]=u=>e.instructionService.nextStep()),onPrev:t[1]||(t[1]=u=>e.instructionService.prevStep()),onClose:t[2]||(t[2]=u=>e.instructionService.nextStep(6))},null,8,["steps_count","step","is-visible"])],2),p("div",{class:d(["cabinet__block onboarding_block cabinet__block-card cabinet__block-light income__block income__block-full",{"onboarding_block-target":e.instructionService.isVisible&&e.instructionService.step===2}])},[o(l,{title:s.$t("block.titles.month_profit"),bitcoin:s.getAccount.last_month_amount||0},null,8,["title","bitcoin"]),e.service.waitGraphChange?C("",!0):(h(),g(M,{key:0,height:130,"graph-data":e.service.graphService.graph},null,8,["graph-data"])),o(b,{step_active:2,steps_count:e.instructionService.steps_count,step:e.instructionService.step,"is-visible":e.instructionService.isVisible,text:"texts.income[1]",title:"titles.income[1]","class-name":"onboarding__card-right",onNext:t[3]||(t[3]=u=>e.instructionService.nextStep()),onPrev:t[4]||(t[4]=u=>e.instructionService.prevStep()),onClose:t[5]||(t[5]=u=>e.instructionService.nextStep(6))},null,8,["steps_count","step","is-visible"])],2)]),o(P,{class:d(["onboarding_block slider-income",{"onboarding_block-target":e.instructionService.isVisible&&e.instructionService.step===3}]),wait:e.service.isWait,empty:e.service.isEmpty,end:e.service.isEnd,"rows-num":"1000","have-nav":!1,table:e.service.table},{instruction:y(()=>[o(b,{step_active:3,steps_count:e.instructionService.steps_count,step:e.instructionService.step,"is-visible":e.instructionService.isVisible,text:"texts.income[2]",title:"titles.income[2]","class-name":"onboarding__card-bottom",onNext:t[6]||(t[6]=u=>e.instructionService.nextStep()),onPrev:t[7]||(t[7]=u=>e.instructionService.prevStep()),onClose:t[8]||(t[8]=u=>e.instructionService.nextStep(6))},null,8,["steps_count","step","is-visible"])]),default:y(()=>[o(E,{table:e.service.table,empty:e.service.isEmpty,wait:e.service.isWait,component:_.IncomeRow},null,8,["table","empty","wait","component"])]),_:1},8,["class","wait","empty","end","table"])]),e.isMounted?(h(),g(K,{key:0,to:".header_button-instruction"},[o(R,{hint:"income",onOpenInstruction:t[9]||(t[9]=u=>e.instructionService.setStep().setVisible())})])):C("",!0)],64)}const Ft=w(dt,[["render",ft],["__scopeId","data-v-0ba08b2b"]]);export{Ft as default};
