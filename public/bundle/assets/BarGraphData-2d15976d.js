var E=Object.defineProperty;var A=(i,s,t)=>s in i?E(i,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[s]=t;var r=(i,s,t)=>(A(i,typeof s!="symbol"?s+"":s,t),t);import{C as X}from"./converter-ec486320.js";import{m as C,_ as v,r as c,o as _,c as g,d as p,h as b,b as m,t as h,a,j as M,p as B,e as H}from"./app-7a3a58ff.js";import{M as y}from"./MainTitle-5abaae33.js";import{T as S}from"./TooltipCard-430f11e3.js";import{s as f,m as d,l as w,p as N,b as W}from"./transform-fa9976d2.js";import{a as G}from"./anime.es-de4e5aa0.js";import{D as P}from"./DefaultSubsService-b95954c2.js";const L={name:"BtcCalculator",components:{MainTitle:y,TooltipCard:S},props:{bitcoin:{type:Number,default:0},title:String,clearProfit:Number},computed:{...C(["btcInfo"])},data(){return{converter:null}},watch:{btcInfo:{deep:!0,handler(){this.updateConversion()}},BTC(){this.updateConversion()}},mounted(){this.updateConversion()},methods:{async updateConversion(){var i,s;this.converter=new X(this.bitcoin,((s=(i=this.btcInfo)==null?void 0:i.btc)==null?void 0:s.price)??0),await this.converter.convert()}}},V=i=>(B("data-v-714e10cc"),i=i(),H(),i),k={class:"btc__block"},j={class:"btc__value btc-calc-num"},O={class:"btc_num"},R=V(()=>a("div",{class:"btc_unit"},"BTC",-1)),F={class:"convertor-container is-web"},Y={class:"convertor-calc"},U={key:0,class:"convertor-calc"};function z(i,s,t,e,o,n){var D,T,x,I,$;const l=c("main-title"),u=c("tooltip-card");return _(),g("div",k,[p(l,{class:"headline"},{default:b(()=>[m(h(t.title),1)]),_:1}),a("div",j,[a("div",O,[m(h((D=o.converter)==null?void 0:D.btc)+" ",1),R]),a("div",F,[a("span",Y,"$ "+h((T=o.converter)==null?void 0:T.usd),1),i.$i18n.locale==="ru"?(_(),g("span",U,h((x=o.converter)==null?void 0:x.rub)+" ₽",1)):M("",!0)]),p(u,{class:"is-mobile",text:"$"+((I=o.converter)==null?void 0:I.usd)+" ≈ "+(($=o.converter)==null?void 0:$.rub)+" ₽"},null,8,["text"])])])}const Nt=v(L,[["render",z],["__scopeId","data-v-714e10cc"]]);const K={name:"tooltip-bar-icon"},Q=i=>(B("data-v-8f40ee0a"),i=i(),H(),i),Z={width:"16",height:"8",viewBox:"0 0 16 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},q=Q(()=>a("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.58579 6.58481C7.36684 7.36586 8.63316 7.36586 9.41421 6.58481L16 -0.000976562L-3.49691e-07 -0.000975863L6.58579 6.58481Z"},null,-1)),J=[q];function tt(i,s,t,e,o,n){return _(),g("svg",Z,J)}const st=v(K,[["render",tt],["__scopeId","data-v-8f40ee0a"]]);class et{constructor(){r(this,"graphData",{});r(this,"containerHeight",null);r(this,"containerWidth",null);r(this,"x",null);r(this,"y",null);r(this,"svg",null);r(this,"chartHtml",null);r(this,"d3Tooltip",null);r(this,"tooltipHtml",null);r(this,"fullDate",null);r(this,"time",null);r(this,"mouseX",null);r(this,"clientX",null)}setGraphData(s){return this.graphData=s,this}setContainerHeight(s){return this.containerHeight=s,this}setContainerWidth(s){return this.containerWidth=s,this}setChartHtml(s){return this.chartHtml=s,this}setTooltipHtml(s){return this.tooltipHtml=s,this}setMouseX(s){return this.mouseX=s,this}createSvg(){return this.svg=f(this.chartHtml).append("svg").attr("width","100%").attr("height",this.containerHeight),this}createTooltip(){return this.d3Tooltip=f(this.tooltipHtml),this}dropGraph(){return this.svg&&(this.svg.selectAll("*").remove(),this.svg._groups[0][0].remove()),this}getNearestIndex(){return Math.round(this.x.invert(this.mouseX))}emptyValidationRules(){return d(this.graphData.values)!==0?d(this.graphData.values)+d(this.graphData.values)*.2:120}setX(){return this.x=w().domain(this.graphData.dates.map((s,t)=>t)).range([0,this.containerWidth]),this}setY(){return this.y=w().domain([0,this.emptyValidationRules()]).range([this.containerHeight,0]),this}setDate(s){const t=new Date(this.graphData.dates[s]);return this.fullDate=t.getUTCFullYear(),this.time=t.getDate().toString().padStart(2,"0")+"."+(t.getMonth()+1).toString().padStart(2,"0"),this}mouseEnterEventAction(){}mouseLeaveEventAction(){}setSvgEvents(){return this.svg.on("mousemove",s=>{const t=N(s)[0];this.mouseEnterEventAction(s,t)}),this.svg.on("mouseleave",()=>{this.d3Tooltip.style("opacity",0),this.mouseLeaveEventAction()}),this}setMobileSvgEvents(){return this.svg.on("touchstart",s=>{const t=s.touches[0].clientX-this.svg.node().getBoundingClientRect().left;this.mouseEnterEventAction(s,t)}),this.svg.on("touchmove",s=>{const t=s.touches[0].clientX-this.svg.node().getBoundingClientRect().left;this.mouseEnterEventAction(s,t)}),this.svg.on("touchend",()=>{this.d3Tooltip.style("opacity",0),this.mouseLeaveEventAction()}),this}}class it extends et{constructor(){super(...arguments);r(this,"tooltipIconHtml",null);r(this,"d3TooltipIcon",null);r(this,"mining",null);r(this,"barData",null)}setTooltipIconHtml(t){return this.tooltipIconHtml=t,this}createTooltipIcon(){return this.d3TooltipIcon=f(this.tooltipIconHtml),this}setX(){return this.x=W().domain(this.graphData.dates.map((t,e)=>e)).range([0,this.containerWidth]).padding(.12),this}emptyValidationRules(){return d(this.graphData.values)!==0?d(this.graphData.values):.005}getBarHeight(t){return this.containerHeight-this.y(t)+8}appendBars(){return this.svg.selectAll("rect").data(this.graphData.values).join("rect").attr("x",(t,e)=>this.x(e)).attr("y",t=>this.y(t)-2).attr("width",this.x.bandwidth()).attr("height",this.getBarHeight.bind(this)).attr("ry",6).attr("rx",6).attr("class","bar"),this}graphAppends(){return this.appendBars(),this}mouseEnterEventAction(t,e){const o=this.getClosestPoint(e);this.setMouseX(e),this.updateTooltip(t,o)}mouseLeaveEventAction(){this.d3TooltipIcon.style("opacity",0),this.dropBarsStyles()}setMining(t){this.mining=this.graphData.values[t]}setActualValues(t){this.setDate(t),this.setMining(t)}updateTooltip(t,e){this.tooltipInit(t,e),e!=null&&e.y&&(this.d3Tooltip.style("top",e.y-this.tooltipHtml.clientHeight-4+"px").style("opacity",1),this.d3TooltipIcon.style("opacity",1).style("top",e.y-4+"px"))}getPosition(){if(this.mouseX){let t=this.tooltipHtml.clientWidth;const e=this.mouseX<t,o=this.mouseX>this.containerWidth-t,n=this.barData.index*this.barData.width+this.barData.width/2;return{side:"left",position:e?0:o?this.containerWidth-t:n-t/2}}}tooltipInit(t){try{t!=null&&t.touches?this.clientX=t.touches[0].clientX:this.clientX=t.clientX,this.setMouseX(this.mouseX);const e=this.barData.index;this.setActualValues(e);const o=this.getPosition();if(new Date(this.graphData.dates[e]).toLocaleTimeString()!=="Invalid Date"){this.d3Tooltip.style("opacity",1).style(o.side,o.position+"px");const n=this.barData.index*this.barData.width+this.barData.width/2;this.d3TooltipIcon.style("left",n).style("right","auto"),n<18||n>this.containerWidth-18?this.d3TooltipIcon.style("display","none"):this.d3TooltipIcon.style("display","flex")}}catch(e){console.error(e)}}dropBarsStyles(){this.svg.selectAll(".bar").nodes().forEach(e=>{e.setAttribute("style","transition: all 0.1s ease 0s;")})}getBarData(t){const e=this.containerWidth/this.svg.selectAll(".bar").nodes().length;return{width:e,index:Math.floor(t/e)}}getClosestPoint(t){const e=this.svg.selectAll(".bar").nodes();let o=null;if(this.barData=this.getBarData(t),e.forEach((n,l)=>{n.setAttribute("style","transition: all 0.1s ease 0s;"),this.barData.index===l&&(o=n,n.setAttribute("style","fill: #2E90FA; transition: all 0.1s ease 0s;"))}),o){const n=o.getBoundingClientRect();return{x:t,y:this.containerHeight-n.height}}return null}}const ot={name:"MainColumnGraph",components:{TooltipBarIcon:st,MainTitle:y},props:{graphData:Object,height:Number},data(){return{graph:this.graphData,service:new it(this.graphData,this.$t)}},computed:{...C(["viewportWidth"])},watch:{graphData(i){this.service.setGraphData(i).dropGraph(),this.graphInit()},viewportWidth(){this.service.dropGraph(),this.graphInit()}},mounted(){this.service.dropGraph().setChartHtml(this.$refs.chart).setTooltipHtml(this.$refs.tooltip).setTooltipIconHtml(this.$refs.tooltip_icon.$el).createTooltip().createTooltipIcon(),this.graphInit()},methods:{graphInit(){this.graphData&&(this.service.setGraphData(this.graphData).setContainerHeight(this.height).setContainerWidth(this.$refs.chart.offsetWidth).createSvg().setY().setX().graphAppends(),this.viewportWidth>991.98?this.service.setSvgEvents():this.service.setMobileSvgEvents())}}},at={class:"chart chart-bar"},nt={ref:"chart",class:"container-chart"},rt={ref:"tooltip",class:"tooltip",style:{opacity:"0"}},ht={class:"tooltip__content"},lt={class:"tooltip_text"},ct={class:"tooltip_value"},pt={class:"tooltip_text tooltip_text-mining"},ut={class:"tooltip_label"},dt={class:"tooltip_value"};function _t(i,s,t,e,o,n){const l=c("main-title"),u=c("tooltip-bar-icon");return _(),g("div",at,[p(l,{class:"headline"},{default:b(()=>[m(h(i.$t("statistic.graph[0]")),1)]),_:1}),a("div",nt,[a("div",rt,[a("div",ht,[a("p",lt,[a("span",ct,h(isNaN(o.service.time)?"":o.service.time)+"."+h(isNaN(o.service.fullDate)?"..":o.service.fullDate),1)]),a("p",pt,[a("span",ut,h(i.$t("statistic.graph[1]"))+": ",1),a("span",dt,h(o.service.mining||0)+" BTC ",1)])])],512),p(u,{ref:"tooltip_icon",class:"tooltip_icon",style:{opacity:"0"}},null,512)],512)])}const Wt=v(ot,[["render",_t],["__scopeId","data-v-da29cbc3"]]);const gt={name:"main-progress-bar",props:{title:String,hint:String,progress:Number,final:Number,unit:String},components:{MainTitle:y,TooltipCard:S},computed:{percent(){const i=this.final/100;return this.progress/i}},watch:{progress(){this.initProgress()}},methods:{initProgress(){G({targets:this.$refs.progress_line,width:`${this.percent}%`,easing:"easeInOutQuad"})}},mounted(){this.initProgress()}},mt={class:"progress"},vt={class:"progress__head"},ft={class:"progress_icon"},bt={class:"progress__block"},yt={class:"progress__row"},Dt={class:"progress_value"},Tt={class:"progress_value"},xt={class:"progress__bar"},It={class:"progress_line",ref:"progress_line"};function $t(i,s,t,e,o,n){const l=c("main-title"),u=c("TooltipCard");return _(),g("div",mt,[a("div",vt,[p(l,{class:"headline card-title"},{default:b(()=>[m(h(t.title),1)]),_:1}),a("div",ft,[p(u,{text:i.$t("statistic.info_blocks.tooltip[0]")+t.progress+t.unit+". "+i.$t("statistic.info_blocks.tooltip[1]")+" "+t.final+t.unit},null,8,["text"])])]),a("div",bt,[a("div",yt,[a("span",Dt,h(t.progress)+" "+h(t.unit),1),a("span",Tt,h(t.final)+" "+h(t.unit),1)]),a("div",xt,[a("span",It,null,512)])])])}const Gt=v(gt,[["render",$t],["__scopeId","data-v-a6a27d95"]]),wt={terahash:"T",petahash:"P",exsahash:"E"};class Pt extends P{constructor(s=96){super(),this.offset=s,this.graph={},this.records=[],this.translate=null}setTranslate(s){this.translate=s}setOffset(s){this.offset=s}setDates(s=60*60*1e3){const t=new Date().getTime();return Array.from({length:this.offset},(e,o)=>new Date(t-(this.offset-1-o)*s).getTime())}setDefaultKeys(s){this.graph={...this.graph,dates:this.setDates(s)}}randomizeTest(s,t){return Math.random()*(t-s)+s}async makeFullValues(){const[s,t,e]=this.records.slice(-this.offset).reduce((o,n)=>(o[0].push(n.hashrate||0),o[1].push(n.amount||0),o[2].push(n.unit||"T"),o),[[],[],[]]);for(;s.length<this.offset;)s.push(0),t.push("0"),e.push(wt.terahash);Object.assign(this.graph,{values:s.reverse(),amount:t.map(String).reverse(),unit:e.reverse()})}async makeFullBarValues(){const[s]=this.records.slice(-this.offset).reduce((t,e)=>(t[0].push(e.amount||0),t),[[]]);for(;s.length<30;)s.push(0);Object.assign(this.graph,{values:s.reverse()})}}class Lt{constructor(s){s.income?this.amount=Number(s.income.split(" ")[0]):this.amount=Number(s.amount)}}export{Nt as B,Pt as G,Wt as M,Gt as a,Lt as b};
